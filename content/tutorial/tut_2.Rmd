---
title: "Introduction to Parallel Computing"
date: 13 November 2018
output: html_document
---
<style type="text/css">
body{ /* Normal  */
      font-size: 14px;
  }
h1 { /* Header 1 */
  font-size: 20px;
  color: DarkGreen;
}
h2 { /* Header 2 */
    font-size: 22px;
  color: DarkGreen;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>

Why use parallel processing? The simple answer is time.
If something takes less time done through parallel processing, why not do it? Computers nowadays have multi core processors with sufficient amount of memory available to run parallel processing. Instead of waiting a long time for a task to complete, one can divide the taks to run in multiple cores and thus obtain outputs much faster.

## R packages

There are many packages to run parallel processing in R. Here are a few examples:

* parallel
* snow
* doSNOW
* doParallel
* foreach



First install packages `r<install.packages("parallel")>'

Then set up a parallel cluster.
Use the "parallel" library to detect the number of cores in your computer
```{r}
library(parallel)
nc <- detectCores()
```
Set the cluster with nc - 1 (always leave one core free for the machine to run its other processes)
```{r}
cl <- makeCluster(nc - 1)
```
This will create a SOCK cluster, which can be done in all operating systems.
If you want to create a FORK cluster (which has better capabilities to manage memory)
"cl <- makeCluster(nc-1, type = "FORK")"
note, however, that Windows does not support FORK clusters

## for loops and foreach

An intuitive way to perform a parallel process is to use the foreach function which looks like a for loop but operates more as a lapply() function. As a first example we will perform the foreach function in sequential by using %do%

```{r}
library(foreach)
foreach(i = 1:5) %do% {
  sqrt(i)
}

```
In the example above we applied "sqrt" on each "i". 
By default, foreach returns the output in a list format. You can combine the results in different ways. For instance if you want a vector output use the following you can add the argument ".combine = c" 
```{r}
foreach(i = 1:5, .combine = c) %do% {
  sqrt(i)
}

```
If the output is a matrix and you want to combine the results by rows, you can use ".combine = rbind".



## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
